(this["webpackJsonpmeal-selector"]=this["webpackJsonpmeal-selector"]||[]).push([[0],{11:function(e,t,n){e.exports={MealCard:"MealCard_MealCard__26Yvk",Selected:"MealCard_Selected__2PPtQ",Hidden:"MealCard_Hidden__1pzE-",Title:"MealCard_Title__R-MOE",Add:"MealCard_Add__24PAG",RMHolder:"MealCard_RMHolder__Bsk2Y",RemoveMeal:"MealCard_RemoveMeal__3eLZ7"}},13:function(e,t,n){e.exports={Selector:"Selector_Selector__J2pJn",Button:"Selector_Button__3iUmT",AuthButton:"Selector_AuthButton__1ratr"}},16:function(e,t,n){e.exports={Auth:"Auth_Auth__1GNAK"}},17:function(e,t,n){e.exports={ShoppingList:"ShoppingList_ShoppingList__1dlPf",NewItem:"ShoppingList_NewItem__N_7Xp",Add:"ShoppingList_Add__2stgp"}},31:function(e,t,n){e.exports={Content:"Layout_Content__PrDi6"}},32:function(e,t,n){e.exports={RemoveButton:"RemoveButton_RemoveButton__1uEds"}},33:function(e,t,n){e.exports={Button:"Button_Button__3gFiX"}},34:function(e,t,n){e.exports={Modal:"Modal_Modal__1-5dN"}},35:function(e,t,n){e.exports={Backdrop:"Backdrop_Backdrop__3j6VK"}},36:function(e,t,n){e.exports={loader:"Spinner_loader__fTuX5",load7:"Spinner_load7__3lEXz"}},37:function(e,t,n){e.exports={LoginModal:"AuthModal_LoginModal__31OlZ"}},50:function(e,t,n){},51:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),i=n.n(a),o=n(14),s=n.n(o),c=n(5),l=n(10),d=(n(50),n(3)),u=n(4),p=n(7),g=n(6),h=(n(51),function(e){return e.children}),m=n(31),j=n.n(m),b=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(r.jsxs)(h,{children:[Object(r.jsx)("main",{className:j.a.Content,children:this.props.children}),Object(r.jsxs)("footer",{children:[Object(r.jsx)("hr",{style:{width:"90%"}}),Object(r.jsxs)("p",{children:[Object(r.jsx)("a",{href:"https://github.com/georgeharvey3",children:"George Harvey"})," 2020"]})]})]})}}]),n}(a.Component),f=n(2),O=n(15),I=n.n(O),v=I.a.create({baseURL:"https://meal-selector-525ee-default-rtdb.firebaseio.com/"}),A="ADD_MEAL_SUCCESS",S="ADD_MEAL_LOCAL",_="REMOVE_MEAL_SUCCESS",M="REMOVE_MEAL_LOCAL",x="ADD_INGREDIENT_SUCCESS",y="UPDATE_INGREDIENT_SUCCESS",E="ADD_INGREDIENT_LOCAL",N="REMOVE_INGREDIENT_SUCCESS",k="REMOVE_INGREDIENT_LOCAL",C="SELECT_MEAL",w="DESELECT_MEAL",L="ADD_ITEM",D="SET_MEALS",T="FETCH_MEALS_START",R="FETCH_MEALS_SUCCESS",F="FETCH_MEALS_FAILED",U="FETCH_MEALS_LOCAL",P="AUTH_START",B="AUTH_SUCCESS",H="AUTH_FAIL",G="AUTH_LOGOUT",V="SET_AUTH_REDIRECT_PATH",K=function(e,t){return function(n){n({type:"ADD_MEAL_START"}),v.post("/meals.json?auth="+t,e).then((function(t){console.log(t),e.id=t.data.name,n(function(e){return{type:A,meal:e}}(e))})).catch((function(e){n(function(e){return{type:"ADD_MEAL_FAILED",error:e}}(e))}))}},J=function(e,t){return function(n){n({type:"REMOVE_MEAL_START"}),v.delete("/meals/"+e+".json?auth="+t).then((function(t){n(function(e){return{type:_,mealId:e}}(e))})).catch((function(e){n(function(e){return{type:"REMOVE_MEAL_FAILED",error:e}}(e))}))}},Y=function(e,t,n){return function(r){r({type:"ADD_INGREDIENT_START"}),v.post("/meals/"+e+"/ingredients.json?auth="+n,t).then((function(n){t.id=n.data.name,r(function(e,t){return{type:x,mealId:e,ingredient:t}}(e,t))})).catch((function(e){console.log(e),r(function(e){return{type:"ADD_INGREDIENT_FAILED",error:e}}(e))}))}},Q=function(e,t,n){return function(r){r({type:"UPDATE_INGREDIENT_START"}),v.put("/meals/".concat(e,"/ingredients/").concat(t.id,".json?auth=").concat(n),t).then((function(){r(function(e,t){return{type:y,mealId:e,ingredient:t}}(e,t))})).catch((function(e){console.log(e),r(function(e){return{type:"UPDATE_INGREDIENT_FAILED",error:e}}(e))}))}},X=function(e,t,n){return function(r){r({type:"REMOVE_INGREDIENT_START"}),v.delete("/meals/"+e+"/ingredients/"+t+".json?auth="+n).then((function(n){r(function(e,t){return{type:N,mealId:e,ingredientId:t}}(e,t))})).catch((function(e){r(function(e){return{type:"REMOVE_INGREDIENT_FAILED",error:e}}(e))}))}},z=function(e,t){return function(n){n({type:T});var r="?auth="+e+'&orderBy="userId"&equalTo="'+t+'"';v.get("/meals.json"+r).then((function(e){var t=[];for(var r in e.data){var a=[];for(var i in e.data[r].ingredients)a.push(Object(f.a)(Object(f.a)({},e.data[r].ingredients[i]),{},{id:i}));t.push({id:r,name:e.data[r].name,ingredients:a})}n({type:R,meals:t})})).catch((function(e){console.log(e),n(function(e){return{type:F,error:e}}(e))}))}},W=function(e,t){return{type:B,token:e,userId:t}},q=function(){return{type:G}},Z=function(e){return function(t){setTimeout((function(){t(q())}),1e3*e)}},$=function(e,t,n){return function(r){r({type:P});var a={email:e,password:t,returnSecureToken:!0},i="https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCnbemvp5S8YOEwbdizrQFOaY6guuW7Q8M";n&&(i="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCnbemvp5S8YOEwbdizrQFOaY6guuW7Q8M"),I.a.post(i,a).then((function(e){var t=new Date((new Date).getTime()+1e3*e.data.expiresIn);localStorage.setItem("token",e.data.idToken),localStorage.setItem("expirationTime",t),localStorage.setItem("userId",e.data.localId),r(W(e.data.idToken,e.data.localId)),r(Z(e.data.expiresIn))})).catch((function(e){var t;r((t=e.response.data.error,{type:H,error:t}))}))}},ee=n(32),te=n.n(ee),ne=function(e){return Object(r.jsx)("button",{className:te.a.RemoveButton,onClick:e.clicked,children:e.children})},re=n(33),ae=n.n(re),ie=function(e){return Object(r.jsx)("button",{className:ae.a.Button,onClick:e.clicked,children:e.children})},oe=n(11),se=n.n(oe),ce=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={selected:!1,addingIngredient:!1,showIngredients:Boolean(e.props.new),editIngredient:""},e.componentDidMount=function(){e.props.meal&&0===e.props.meal.ingredients.length&&e.setState({showIngredients:!0})},e.onAddIngredientClicked=function(){e.setState((function(e){return{addingIngredient:!e.addingIngredient}}))},e.toggleShowIngredients=function(){e.setState((function(e){return{showIngredients:!e.showIngredients,editIngredient:""}}))},e.toggleSelectMeal=function(){e.props.new||(e.state.selected?e.props.onDeselectMeal(e.props.meal.name):e.props.onSelectMeal(e.props.meal.name),e.setState((function(e){return{selected:!e.selected}})))},e.onAddIngredientKeyPress=function(t){if("Enter"===t.key){e.setState({addingIngredient:!1});var n={ingredientName:t.target.value};e.props.isAuthenticated?e.props.onAddIngredient(e.props.meal.id,n,e.props.token):e.props.onAddIngredientLocal(e.props.meal.name,n)}},e.removeIngredientClicked=function(t){e.props.isAuthenticated&&e.props.onRemoveIngredient(e.props.meal.id,t,e.props.token)},e.onAddIngredientSubmit=function(t){t.preventDefault();var n=new FormData(t.target),r=Object.fromEntries(n.entries());e.setState({addingIngredient:!1}),e.props.isAuthenticated?e.props.onAddIngredient(e.props.meal.id,r,e.props.token):e.props.onAddIngredientLocal(e.props.meal.name,r)},e.onIngredientClick=function(t){e.setState({editIngredient:t})},e.onUpdateIngredientSubmit=function(t,n){t.preventDefault();var r=new FormData(t.target),a=Object.fromEntries(r.entries());a=Object(f.a)(Object(f.a)({},a),{},{id:n}),e.setState({addingIngredient:!1}),e.props.isAuthenticated&&e.props.onUpdateIngredient(e.props.meal.id,a,e.props.token),e.setState({editIngredient:""})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=[se.a.MealCard];this.state.selected&&t.push(se.a.Selected);var n,a=null;this.state.addingIngredient&&(a=Object(r.jsxs)("form",{onSubmit:this.onAddIngredientSubmit,children:[Object(r.jsx)("input",{name:"ingredientName",placeholder:"Ingredient Name",autoFocus:!0}),Object(r.jsx)("input",{name:"quantity",placeholder:"Quantity (g)"}),Object(r.jsx)("input",{name:"protein",placeholder:"Protein per 100g"}),Object(r.jsx)("input",{type:"submit"})]}));var i=[];if(this.props.new)n=Object(r.jsx)("input",{onKeyPress:this.props.addMealKeyPress,autoFocus:!0});else{var o=this.props.meal.ingredients.reduce((function(e,t){return e+Number((t.protein||0)*(t.quantity/100||1))}),0)||null;o&&(o="Protein: "+o+"g"),n=Object(r.jsxs)(h,{children:[Object(r.jsx)("h3",{children:this.props.meal.name}),Object(r.jsx)("h4",{children:o}),Object(r.jsx)(ie,{clicked:this.toggleShowIngredients,children:this.state.showIngredients?"Hide Ingredients":"Show Ingredients"})]}),this.props.meal.ingredients&&this.props.meal.ingredients.length>0&&(i=this.props.meal.ingredients.map((function(t,n){return t.ingredientName!==e.state.editIngredient?Object(r.jsxs)("li",{children:[Object(r.jsx)(ne,{className:se.a.Remove,clicked:function(){return e.removeIngredientClicked(t.id)},children:"X"}),Object(r.jsx)("p",{onClick:function(){return e.onIngredientClick(t.ingredientName)},children:t.ingredientName})]},n):Object(r.jsxs)("form",{onSubmit:function(n){return e.onUpdateIngredientSubmit(n,t.id)},children:[Object(r.jsx)("input",{name:"ingredientName",placeholder:"Ingredient Name",autoFocus:!0,defaultValue:t.ingredientName}),Object(r.jsx)("input",{name:"quantity",placeholder:"Quantity (g)",defaultValue:t.quantity}),Object(r.jsx)("input",{name:"protein",placeholder:"Protein per 100g",defaultValue:t.protein}),Object(r.jsx)("input",{type:"submit"})]},n)})))}var s=Object(r.jsxs)(h,{children:[Object(r.jsx)("hr",{}),Object(r.jsx)("ul",{children:i}),a,Object(r.jsx)("button",{className:se.a.Add,onClick:this.onAddIngredientClicked,children:this.state.addingIngredient?"-":"+"})]});this.state.showIngredients||(s=null);var c=this.state.selected?"rgb(112, 112, 112)":"rgb(53, 110, 53)",l="1";return this.props.new&&(c="rgb(112, 112, 112)",l=.5),Object(r.jsxs)("div",{className:t.join(" "),children:[Object(r.jsxs)("div",{className:se.a.RMHolder,children:[Object(r.jsx)("button",{className:c,style:{backgroundColor:c,opacity:l},onClick:this.toggleSelectMeal,children:this.state.selected?"Deselect":"Select"}),Object(r.jsx)("button",{style:{backgroundColor:"rgb(180, 66, 66)"},onClick:this.props.removeMealClicked,children:"Delete"})]}),Object(r.jsx)("div",{className:se.a.Title,children:n}),s]})}}]),n}(a.Component),le=Object(c.b)((function(e){return{selectedMeals:e.meals.selectedMeals,token:e.auth.token,isAuthenticated:null!==e.auth.token}}),(function(e){return{onAddIngredient:function(t,n,r){return e(Y(t,n,r))},onAddIngredientLocal:function(t,n){return e(function(e,t){return{type:E,mealName:e,ingredient:t}}(t,n))},onUpdateIngredient:function(t,n,r){return e(Q(t,n,r))},onRemoveIngredient:function(t,n,r){return e(X(t,n,r))},onRemoveIngredientLocal:function(t,n){return e(function(e,t){return{type:k,mealName:e,ingredientName:t}}(t,n))},onSelectMeal:function(t){return e(function(e){return{type:C,mealName:e}}(t))},onDeselectMeal:function(t){return e(function(e){return{type:w,mealName:e}}(t))}}}))(ce),de=n(34),ue=n.n(de),pe=n(35),ge=n.n(pe),he=function(e){return e.show?Object(r.jsx)("div",{className:ge.a.Backdrop,onClick:e.clicked}):null},me=function(e){return Object(r.jsxs)(h,{children:[Object(r.jsx)(he,{show:e.show,clicked:e.modalClosed}),Object(r.jsx)("div",{className:ue.a.Modal,style:{transform:e.show?"translateY(0)":"translateY(-100vh)",display:e.show?"block":"none",opactiy:e.show?"1":"0"},children:e.children})]})},je=n(17),be=n.n(je),fe=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={addingItem:!1},e.getIngredients=function(e){for(var t={},n=0;n<e.length;n++)for(var r=e[n],a=0;a<r.ingredients.length;a++)r.ingredients[a].ingredientName in t?t[r.ingredients[a].ingredientName]+=1:t[r.ingredients[a].ingredientName]=1;return t},e.onAddItemClicked=function(){e.setState({addingItem:!0})},e.onAddIngredientKeyPress=function(t){if("Enter"===t.key){e.setState({addingItem:!1});var n={ingredientName:t.target.value};e.props.onAddItem(n)}},e}return Object(u.a)(n,[{key:"render",value:function(){var e,t=this,n=this.getIngredients(this.props.selectedMeals);return this.state.addingItem&&(e=Object(r.jsx)("input",{className:be.a.NewItem,onKeyPress:this.onAddIngredientKeyPress,autoFocus:!0,onBlur:function(){t.setState({addingIngredient:!1})}})),Object(r.jsxs)("div",{className:be.a.ShoppingList,children:[Object(r.jsx)("h3",{children:"Your Shopping List:"}),Object(r.jsx)("ul",{children:Object.keys(n).map((function(e){var t="";if(n[e]>1){t+=" ";for(var a=0;a<n[e];a++)t+="*"}return Object(r.jsxs)("li",{children:[Object(r.jsx)("input",{type:"checkbox"}),Object(r.jsx)("p",{children:e+t})]},e)}))}),e,Object(r.jsx)("button",{className:be.a.Add,onClick:this.onAddItemClicked,children:"+"})]})}}]),n}(a.Component),Oe=Object(c.b)((function(e){return{selectedMeals:e.meals.selectedMeals}}),(function(e){return{onAddItem:function(t){return e(function(e){return{type:L,newItem:e}}(t))}}}))(fe),Ie=n(12),ve=n(16),Ae=n.n(ve),Se=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:""},e.submitHandler=function(t){t.preventDefault(),e.props.onAuth(e.state.email,e.state.password,!1)},e.onUpdateField=function(t,n){e.setState(Object(Ie.a)({},n,t.target.value))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:Ae.a.Auth,children:[Object(r.jsx)("h3",{children:"Login"}),this.props.errorMessage,Object(r.jsxs)("form",{children:[Object(r.jsx)("input",{id:"loginInput",placeholder:"Email",onChange:function(t){return e.onUpdateField(t,"email")},autoFocus:!0}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"password",placeholder:"Password",onChange:function(t){return e.onUpdateField(t,"password")}}),Object(r.jsx)("br",{}),Object(r.jsx)("button",{onClick:this.submitHandler,children:"Sign In"})]}),Object(r.jsxs)("p",{children:["Don't have an account? ",Object(r.jsx)("span",{onClick:this.props.toggleAuth,children:"Sign Up"})]})]})}}]),n}(a.Component),_e=Object(c.b)(null,(function(e){return{onAuth:function(t,n,r){return e($(t,n,r))}}}))(Se),Me=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:""},e.submitHandler=function(t){t.preventDefault(),e.props.onAuth(e.state.email,e.state.password,!0)},e.onUpdateField=function(t,n){e.setState(Object(Ie.a)({},n,t.target.value))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:Ae.a.Auth,children:[Object(r.jsx)("h3",{children:"Register"}),this.props.errorMessage,Object(r.jsxs)("form",{children:[Object(r.jsx)("input",{placeholder:"Email",onChange:function(t){return e.onUpdateField(t,"email")},autoFocus:!0}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"password",placeholder:"Password",onChange:function(t){return e.onUpdateField(t,"password")}}),Object(r.jsx)("br",{})]}),Object(r.jsx)("button",{onClick:this.submitHandler,children:"Sign Up"}),Object(r.jsxs)("p",{children:["Already have an account? ",Object(r.jsx)("span",{onClick:this.props.toggleAuth,children:"Login"})]})]})}}]),n}(a.Component),xe=Object(c.b)(null,(function(e){return{onAuth:function(t,n,r){return e($(t,n,r))}}}))(Me),ye=n(36),Ee=n.n(ye),Ne=function(){return Object(r.jsx)("div",{className:Ee.a.loader})},ke=n(37),Ce=n.n(ke),we=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={isRegister:!1},e.onToggleAuth=function(){e.setState((function(e){return{isRegister:!e.isRegister}}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=null;this.props.error&&(e=Object(r.jsx)("p",{children:this.props.error.message}));var t=this.state.isRegister?Object(r.jsx)(xe,{toggleAuth:this.onToggleAuth,errorMessage:e}):Object(r.jsx)(_e,{toggleAuth:this.onToggleAuth,errorMessage:e});return this.props.loading&&(t=Object(r.jsx)(Ne,{})),Object(r.jsxs)(h,{children:[Object(r.jsx)(he,{show:this.props.show,clicked:this.props.modalClosed}),Object(r.jsx)("div",{className:Ce.a.LoginModal,style:{display:this.props.show?"block":"none",opactiy:this.props.show?"1":"0"},children:t})]})}}]),n}(a.Component),Le=Object(c.b)((function(e){return{loading:e.auth.loading,error:e.auth.error}}))(we),De=n(13),Te=n.n(De),Re=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={addingMeal:!1,showList:!1,showErrorModal:!1,errorMessage:"",showLogin:!1},e.componentDidMount=function(){e.props.isAuthenticated||e.props.onFetchMealsLocal()},e.onAddMealClicked=function(){e.setState({addingMeal:!0})},e.onAddMealKeyPress=function(t){if("Enter"===t.key){for(var n=!1,r=0;r<e.props.meals.length;r++)e.props.meals[r].name===t.target.value&&(n=!0);if(n)e.setState({showErrorModal:!0,errorMessage:"You already have a meal named ".concat(t.target.value,"!")});else{e.setState({addingMeal:!1});var a=t.target.value;if(e.props.isAuthenticated){var i={name:a,ingredients:[],userId:e.props.userId};e.props.onAddMeal(i,e.props.token)}else{var o={name:a,ingredients:[]};e.props.onAddMealLocal(o)}}}},e.onShowList=function(){e.setState({showList:!0})},e.onDismissModal=function(){e.setState({showList:!1,showErrorModal:!1})},e.onLoginClicked=function(){e.setState({showLogin:!0}),window.setTimeout((function(){document.getElementById("loginInput").focus()}),0)},e.onLogoutClicked=function(){e.props.onLogout(),e.props.onFetchMealsLocal()},e.onDismissLogin=function(){e.setState({showLogin:!1})},e.removeMealClicked=function(t){e.props.isAuthenticated?e.props.onRemoveMeal(t.id,e.props.token):e.props.onRemoveMealLocal(t.name)},e}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e,t){e.isAuthenticated!==this.props.isAuthenticated&&this.props.isAuthenticated&&(this.props.onFetchMeals(this.props.token,this.props.userId),this.setState({showLogin:!1}))}},{key:"render",value:function(){var e=this,t=null;return this.state.addingMeal&&(t=Object(r.jsx)(le,{new:!0,addMealKeyPress:function(t){return e.onAddMealKeyPress(t)},removeMealClicked:function(){return e.setState({addingMeal:!1})}},0)),Object(r.jsxs)(h,{children:[Object(r.jsx)("h1",{style:{color:"rgb(53, 110, 53)"},children:"Meal Selector"}),this.props.isAuthenticated?Object(r.jsx)("button",{onClick:this.onLogoutClicked,className:Te.a.AuthButton,children:"Logout"}):Object(r.jsx)("button",{onClick:this.onLoginClicked,className:Te.a.AuthButton,children:"Login/Register"}),Object(r.jsx)("br",{}),Object(r.jsx)("button",{className:Te.a.Button,onClick:this.onAddMealClicked,children:"Add Meal"}),Object(r.jsx)("button",{className:Te.a.Button,onClick:this.onShowList,children:"See List"}),Object(r.jsxs)("div",{className:Te.a.Selector,children:[this.props.meals.map((function(t,n){return Object(r.jsx)(le,{meal:t,removeMealClicked:function(){return e.removeMealClicked(t)}},n)})),t]}),Object(r.jsx)(me,{show:this.state.showList,modalClosed:this.onDismissModal,children:Object(r.jsx)(Oe,{})}),Object(r.jsx)(me,{show:this.state.showErrorModal,modalClosed:this.onDismissModal,children:Object(r.jsx)("p",{children:this.state.errorMessage})}),Object(r.jsx)(Le,{show:this.state.showLogin,modalClosed:this.onDismissLogin})]})}}]),n}(a.Component),Fe=Object(c.b)((function(e){return{meals:e.meals.meals,isAuthenticated:null!==e.auth.token,token:e.auth.token,mealError:e.meals.error,userId:e.auth.userId}}),(function(e){return{onAddMeal:function(t,n){return e(K(t,n))},onAddMealLocal:function(t){return e(function(e){return{type:S,meal:e}}(t))},onRemoveMeal:function(t,n){return e(J(t,n))},onRemoveMealLocal:function(t){return e(function(e){return{type:M,mealName:e}}(t))},onFetchMeals:function(t,n){return e(z(t,n))},onFetchMealsLocal:function(){return e({type:U})},onLogout:function(){return e(q())}}}))(Re),Ue=[{name:"curry",ingredients:["rice","spice"]},{name:"soup",ingredients:["vegetables","stock"]},{name:"burger",ingredients:["patty","bun"]},{name:"eggs",ingredients:["egg","bread"]},{name:"salad",ingredients:["lettuce","gin"]},{name:"pasta",ingredients:["pasata","tomato"]}],Pe=function(e){Object(p.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).componentDidMount=function(){e.props.onTryAutoSignin()},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(b,{children:Object(r.jsx)(Fe,{meals:Ue})})})}}]),n}(a.Component),Be=Object(c.b)(null,(function(e){return{onTryAutoSignin:function(){return e((function(e){var t=localStorage.getItem("token");if(t){var n=new Date(localStorage.getItem("expirationTime"));if(n<=new Date)e(q());else{var r=localStorage.getItem("userId");e(W(t,r)),e(Z((n.getTime()-(new Date).getTime())/1e3))}}else e(q())}))}}}))(Pe),He=n(38),Ge=n(8),Ve=function(e,t){return Object(f.a)(Object(f.a)({},e),t)},Ke=[{name:"Carbonara",ingredients:[{ingredientName:"Dijon Mustard"},{ingredientName:"Cashews"},{ingredientName:"Linguine"},{ingredientName:"Almond Flakes"},{ingredientName:"Mushrooms"},{ingredientName:"Parsley"}]},{name:"Sweet Potato Dhal",ingredients:[{ingredientName:"Red Lentils"},{ingredientName:"Onion"},{ingredientName:"Ginger"},{ingredientName:"Sweet Potato"},{ingredientName:"Coconut Milk"},{ingredientName:"Chilli"}]},{name:"Risotto",ingredients:[{ingredientName:"Risotto Rice"},{ingredientName:"Leek"},{ingredientName:"Chestnuts"},{ingredientName:"Walnuts"},{ingredientName:"White Wine"}]}],Je={meals:[],selectedMeals:[],error:!1,loading:!0},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:var n=e.meals.concat(t.meal);return Object(f.a)(Object(f.a)({},e),{},{meals:n});case S:var r=e.meals.concat(t.meal);return localStorage.setItem("meals",JSON.stringify(r)),Object(f.a)(Object(f.a)({},e),{},{meals:r});case _:for(var a,i=Object(Ge.a)(e.meals),o=0;o<i.length;o++)if(i[o].id===t.mealId){a=o;break}return i=i.slice(0,a).concat(i.slice(a+1,i.length)),Object(f.a)(Object(f.a)({},e),{},{meals:i});case M:for(var s,c=Object(Ge.a)(e.meals),l=0;l<c.length;l++)if(c[l].name===t.mealName){s=l;break}return c=c.slice(0,s).concat(c.slice(s+1,c.length)),localStorage.setItem("meals",JSON.stringify(c)),Object(f.a)(Object(f.a)({},e),{},{meals:c});case x:var d=Object(Ge.a)(e.meals),u=d.filter((function(e){return e.id===t.mealId}))[0],p=Object(Ge.a)(u.ingredients),g=p.concat(t.ingredient);return u.ingredients=g,Object(f.a)(Object(f.a)({},e),{},{meals:d});case E:var h=Object(Ge.a)(e.meals),m=h.filter((function(e){return e.name===t.mealName}))[0],j=Object(Ge.a)(m.ingredients),b=j.concat(t.ingredient);return m.ingredients=b,localStorage.setItem("meals",JSON.stringify(h)),Object(f.a)(Object(f.a)({},e),{},{meals:h});case y:var O=e.meals.findIndex((function(e){return e.id===t.mealId})),I=e.meals.slice(0,O),v=e.meals.slice(O+1,e.meals.length),P=Object(f.a)({},e.meals[O]),B=P.ingredients,H=B.findIndex((function(e){return e.id===t.ingredient.id})),G=B.slice(0,H),V=B.slice(H+1,B.length);B=[].concat(Object(Ge.a)(G),[t.ingredient],Object(Ge.a)(V)),P=Object(f.a)(Object(f.a)({},P),{},{ingredients:B});var K=[].concat(Object(Ge.a)(I),[P],Object(Ge.a)(v));return Object(f.a)(Object(f.a)({},e),{},{meals:K});case N:for(var J,Y=Object(Ge.a)(e.meals),Q=Y.filter((function(e){return e.id===t.mealId}))[0],X=Object(Ge.a)(Q.ingredients),z=0;z<X.length;z++)X[z].id===t.ingredientId&&(J=z);var W=X.slice(0,J).concat(X.slice(J+1,X.length));return Q.ingredients=W,Object(f.a)(Object(f.a)({},e),{},{meals:Y});case k:for(var q,Z=Object(Ge.a)(e.meals),$=Z.filter((function(e){return e.name===t.mealName}))[0],ee=Object(Ge.a)($.ingredients),te=0;te<ee.length;te++)ee[te].ingredientName===t.ingredientName&&(q=te);var ne=ee.slice(0,q).concat(ee.slice(q+1,ee.length));return $.ingredients=ne,localStorage.setItem("meals",JSON.stringify(Z)),Object(f.a)(Object(f.a)({},e),{},{meals:Z});case C:var re=e.meals.filter((function(e){return e.name===t.mealName}))[0];return Object(f.a)(Object(f.a)({},e),{},{selectedMeals:e.selectedMeals.concat(re)});case w:for(var ae,ie=0;ie<e.selectedMeals.length;ie++)if(e.selectedMeals[ie].name===t.mealName){ae=ie;break}var oe=e.selectedMeals.slice(0,ae).concat(e.selectedMeals.slice(ae+1,e.selectedMeals.length));return Object(f.a)(Object(f.a)({},e),{},{selectedMeals:oe});case L:var se=Object(Ge.a)(e.selectedMeals);return Object(f.a)(Object(f.a)({},e),{},{selectedMeals:se.concat({ingredients:[t.newItem]})});case D:return Object(f.a)(Object(f.a)({},e),{},{meals:t.meals,error:!1});case T:return Ve(e,{loading:!0});case F:return Ve(e,{loading:!1});case R:return Ve(e,{meals:t.meals,loading:!1,error:!1});case U:var ce=JSON.parse(localStorage.getItem("meals"));return null===ce&&(ce=Ke,localStorage.setItem("meals",JSON.stringify(ce))),Ve(e,{meals:ce,loading:!1,error:!1});default:return e}},Qe={token:null,userId:null,error:null,loading:!1},Xe=function(e,t){return Ve(e,{error:null,loading:!0})},ze=function(e,t){return Ve(e,{token:t.token,userId:t.userId,error:null,loading:!1})},We=function(e,t){return Ve(e,{error:t.error,loading:!1})},qe=function(e,t){return localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),localStorage.removeItem("userId"),Ve(e,{token:null,userId:null})},Ze=function(e,t){return Ve(e,{authRedirectPath:t.path})},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return Xe(e);case B:return ze(e,t);case H:return We(e,t);case G:return qe(e);case V:return Ze(e,t);default:return e}},et=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,tt=Object(l.c)({meals:Ye,auth:$e}),nt=Object(l.e)(tt,et(Object(l.a)(He.a))),rt=Object(r.jsx)(c.a,{store:nt,children:Object(r.jsx)(Be,{})});s.a.render(Object(r.jsx)(i.a.StrictMode,{children:rt}),document.getElementById("root"))}},[[70,1,2]]]);
//# sourceMappingURL=main.3d12e4e8.chunk.js.map